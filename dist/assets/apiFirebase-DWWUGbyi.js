import{i as o,d as s,g as l,c as d,T as c,s as b,a as m,b as g,e as f,f as D,u}from"./index-DqhaZQMH.js";function w(e){return e instanceof c?e.toDate():new Date(e)}async function A(){if(!o||!s)throw new Error("firebase disabled");return(await l(d(s,"announcements"))).docs.map(t=>({id:t.id,...t.data(),date:w(t.data().date)}))}async function p(e){if(!o||!s)throw new Error("firebase disabled");const t=Array.isArray(e.images)?e.images.filter(a=>typeof a=="string"):[],i=Array.isArray(e.files)?e.files.filter(a=>a&&typeof a.name=="string"&&typeof a.url=="string").map(a=>({name:String(a.name),url:String(a.url)})):[],n={title:e.title,content:e.content,priority:e.priority??"normal",date:e.date instanceof Date?c.fromDate(e.date):b()};return{id:(await m(d(s,"announcements"),{...n,images:t,files:i})).id,...e,images:t,files:i}}async function E(e){if(!o||!s)throw new Error("firebase disabled");await g(f(s,"announcements",e))}async function h(){if(!o||!s)throw new Error("firebase disabled");return(await l(d(s,"assignments"))).docs.map(t=>({id:t.id,...t.data(),dueDate:w(t.data().dueDate)}))}async function j(e){if(!o||!s)throw new Error("firebase disabled");const t=e.dueDate instanceof Date?e.dueDate:new Date(e.dueDate),i=Array.isArray(e.images)?e.images.filter(r=>typeof r=="string"):[],n=Array.isArray(e.files)?e.files.filter(r=>r&&typeof r.name=="string"&&typeof r.url=="string").map(r=>({name:String(r.name),url:String(r.url)})):[],a={title:e.title,description:e.description,subject:e.subject,completed:!!e.completed,dueDate:c.fromDate(t)};return{id:(await m(d(s,"assignments"),{...a,images:i,files:n})).id,...e,images:i,files:n}}async function R(e){if(!o||!s)throw new Error("firebase disabled");const t=f(s,"assignments",e),i=await D(t),n=i.exists()?i.data():{completed:!1,dueDate:c.fromDate(new Date)},a=!n.completed;return await u(t,{completed:a}),{id:e,title:n.title??"",description:n.description??"",subject:n.subject??"",completed:a,dueDate:n.dueDate instanceof c?n.dueDate.toDate():new Date}}async function S(e){if(!o||!s)throw new Error("firebase disabled");await g(f(s,"assignments",e))}export{p as fbAddAnnouncement,j as fbAddAssignment,E as fbDeleteAnnouncement,S as fbDeleteAssignment,A as fbGetAnnouncements,h as fbGetAssignments,R as fbToggleAssignment};
